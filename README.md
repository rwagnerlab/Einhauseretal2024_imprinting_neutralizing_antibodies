# Einhauser et al. 2024: Longitudinal effects of SARS-CoV-2 breakthrough infection on imprinting of neutralizing antibody responses
This repository contains code and data for the publication "Longitudinal effects of SARS-CoV-2 breakthrough infection on imprinting of neutralizing antibody responses" published in ...
If you use code or data from this repository, please cite the main publication and link this repository.

## Contents
* Functions Folder: Functions used by the main scripts
* Data: various .xlsx files containing measured longitudinal neutralization data against multiple SARS-CoV-2 variants, information about vaccine status, breakthrough variant and socio deographics, encoded by IDs. (will be uploaded upon acception of the manuscript)
* R scripts for the figures in the manuscript.
## More Info & Contact:
Please visit www.wagner-lab.de or contact the corresponding author of the main publication with the contact details provided there.

## Detailed content description:
The manuscript contains 5 Main Figures and 10 Supplemental Figures as indicated in the script names. 
All code is reliant on *0_initial_dataclear&adjustment_togit.R, please run this before any other code*.
Some code will not output a figure but formated Excel files for Figure design in Graph Pad Prism.
---
### Figure 1:
Will arrange Neutralization data for further design in Graph Pad Prism.
### Figure 2:
Will calculate Magnitude-Breadth curve values from neutralization data and output data for further design in Graph Pad Prism.
### Figure 3:
Will generate Antigenic maps from neutralization data using the Racmacs package. Figure3_plot_mapping.R wil generate the according plot.
### Figure 4:
Will generate Antibody landscapes from the maps and neutralization data. Output as html and raw plots for further design.
### Figure 5:
* Figure5.0_MLDatapreprocess.R will preprocess data for machine learning.
* Figure5.1_machinelearning_rforest.R will generate a battery of datasets and according RandomForest models for classification of breakthrough variant from neutralization titers.
* Figure5.1.1_machinelearning_rforest_var... will extract variant specific accuracies of previously calculated forest models.
* Figure5.2_neuralnets.R: will generate a battery of datasets and according neuralnet models for classification of breakthrough variant from neutralization titers.
---
### Suppl Figure 1:
Will be generated by 0_initial_dataclear&adjustment_togit.R. This will adjust all neutralization data for Follow-up time and studycenter effect using tobit models.
### Suppl Figure 2-4:
Supplfig2_BQJNXBB_Arrange.R, Supplfig3_foldchange.R, Supplfig4_triplevax.R will arrange neutralization data for further design in Prism or calculated foldchanges and arange those values accordingly.
### Suppl Figure 5:
Supplfig51_sensitivityanalysis_vectorvax.R Subgroup analysis of vector vaccinated individuals, including statistics and a figure.
### Suppl Figure 6:
SupplFig6_gams.R will fit genderalized additive models to explore effects of time between vaccination and breakthrough infection. Outputs a figure.
### Suppl Figure 7:
Supplfig7survival-mb.R generates Magnitude breadth curves and according logrank tests, plotted as a heatmap. 
### Suppl Figure 8:
Supplfig8_Triplevax_MB.R Will calculate Magnitude-Breadth curve values from neutralization data and output data for further design in Graph Pad Prism.
### Suppl Figure 9:
SupplFig9_Bootstrap_Maps.R Will perform bootstrapping on antigenic maps to visualize confience of placement.
### Suppl Figure 10:
SupplFig10_3xvax_landscape.R Will generate Antibody landscapes from the maps and neutralization data. Output as html and raw plots for further design.

---
### Multivariate Analysis:
1_multivariate_analysis.R will perform PERMANOVA and pairwise PERMANOVA, outputs model summaries as text.

## Resources:
* The Landscaping code and functions folder uses code from "BA.2 and BA.5 omicron differ immunologically from both BA.1 omicron and pre-omicron variants" by Roessler, A., Netzl, A., et al. 2022; 10.5281/zenodo.7341691
* R Core Team (2022). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.
* Antigenic maps were constructed using the Racmacs package, Version 1.2.9: Wilks S (2022). Racmacs: R Antigenic Cartography Macros. https://acorg.github.io/Racmacs, https://github.com/acorg/Racmacs.
* Antibody landscapes were constructed using the ablandscapes package, Version 1.1.0: https://github.com/acorg/ablandscapes
